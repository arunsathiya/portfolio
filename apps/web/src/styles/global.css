@import '@fontsource-variable/ibm-plex-sans';
@import '@fontsource/ibm-plex-mono/400.css';
@import '@fontsource-variable/instrument-sans';

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer components {
	/* Blog post view prose styles - only for individual posts, not list view */
	.prose:not(.list-view-prose) > *,
	.prose:not(.list-view-prose) p,
	.prose:not(.list-view-prose) ul,
	.prose:not(.list-view-prose) ol,
	.prose:not(.list-view-prose) blockquote,
	.prose:not(.list-view-prose) h1,
	.prose:not(.list-view-prose) h2,
	.prose:not(.list-view-prose) h3,
	.prose:not(.list-view-prose) h4,
	.prose:not(.list-view-prose) h5,
	.prose:not(.list-view-prose) h6 {
		@apply max-w-2xl;
	}

	/* Images, videos, and iframes get full width treatment */
	.prose:not(.list-view-prose)
		:where(img, iframe, video):not(.prose > div img):not(.prose > div:first-child *):not(.prose > div:nth-child(2) *) {
		@apply w-full max-w-none mx-0;
	}

	/* Code blocks get wider than content but not full width */
	.prose:not(.list-view-prose) pre {
		width: 100% !important;
		max-width: 48rem !important;
	}

	/* Ensure regular images still get proper spacing - both individual posts and list view */
	.prose img {
		@apply my-6;
	}

	.prose p:has(img) {
		@apply my-0;
	}

	/* Better spacing between consecutive images */
	.prose img + img {
		@apply mt-8;
	}

	/* Spacing between paragraph and image */
	.prose p + p:has(img),
	.prose p:not(:has(img)) + p:has(img) {
		@apply mt-6;
	}

	/* Spacing after image paragraph before regular paragraph */
	.prose p:has(img) + p:not(:has(img)) {
		@apply mt-6;
	}

	.prose p + p:not(:has(img)) {
		@apply mt-4;
	}

	/* Your existing list view styles */
	.list-view-prose {
		@apply prose dark:prose-invert prose-p:my-2 prose-p:mt-0 prose-img:my-4 prose-img:max-h-48 prose-img:w-auto prose-a:text-blue-600 prose-a:no-underline hover:prose-a:underline dark:prose-a:text-blue-400;
	}

	/* To remove italic formatting from blockquotes */
	.prose blockquote {
		font-style: normal;
	}

	/* To remove bold from quotes if they are bold by default */
	.prose blockquote strong,
	.prose blockquote b {
		font-weight: normal;
	}
}

@layer base {
	/* Support both light and dark color schemes for native UI elements */
	:root {
		color-scheme: light dark;
	}

	/* Honor user preference for reduced motion */
	@media (prefers-reduced-motion: reduce) {
		*,
		*::before,
		*::after {
			animation-duration: 0.01ms !important;
			animation-iteration-count: 1 !important;
			transition-duration: 0.01ms !important;
			scroll-behavior: auto !important;
		}
	}

	/* When explicitly in dark mode, tell browser to use dark native UI */
	.dark {
		color-scheme: dark;
	}

	body {
		font-family: 'IBM Plex Sans', sans-serif;
		font-size: 16px;
		line-height: 1.75;
	}

	pre,
	code {
		font-family: 'IBM Plex Mono', monospace;
		font-size: 1rem;
		width: fit-content;
	}

	/* Scroll margin for heading anchors (accounts for fixed header) */
	h1[id],
	h2[id],
	h3[id],
	h4[id],
	h5[id],
	h6[id] {
		scroll-margin-top: 5rem;
	}

	/* Inline code styling - Highlighter effect */
	.prose :not(pre) > code {
		background: linear-gradient(90deg, rgba(251, 191, 36, 0.2) 0%, rgba(251, 191, 36, 0.05) 100%);
		color: #24292f;
		padding: 0 0.125rem;
		font-size: 0.9em;
		font-weight: 500;
	}

	/* Ensure no pseudo-elements for inline code */
	.prose :not(pre) > code::before,
	.prose :not(pre) > code::after {
		content: none !important;
	}

	/* Dark mode inline code */
	@media (prefers-color-scheme: dark) {
		.prose :not(pre) > code {
			background: linear-gradient(90deg, rgba(251, 191, 36, 0.25) 0%, rgba(251, 191, 36, 0.08) 100%);
			color: #f0f6fc;
		}
	}

	/* Modern code block design with header */
	pre {
		position: relative;
		margin: 1.5rem 0;
		border-radius: 0.75rem;
		overflow: hidden;
		background: linear-gradient(145deg, #1a1a2e 0%, #16162a 100%);
		box-shadow:
			0 4px 6px -1px rgba(0, 0, 0, 0.3),
			0 2px 4px -2px rgba(0, 0, 0, 0.2),
			inset 0 1px 0 rgba(255, 255, 255, 0.05);
		border: 1px solid #2a2a40;
	}

	/* Code block header bar */
	pre::before {
		content: '';
		display: block;
		height: 36px;
		background: linear-gradient(180deg, #252538 0%, #1e1e30 100%);
		border-bottom: 1px solid #2a2a40;
		padding: 0 1rem;
		display: flex;
		align-items: center;
		gap: 0.5rem;
	}

	/* Window controls */
	pre::after {
		content: '● ● ●';
		position: absolute;
		top: 10px;
		left: 1rem;
		color: #ff5f56;
		font-size: 10px;
		letter-spacing: 2px;
		text-shadow:
			0 0 5px #ff5f56,
			0 0 10px #ff5f56;
	}

	pre code {
		display: block;
		padding: 1.25rem;
		font-family: 'IBM Plex Mono', monospace;
		font-size: 0.875rem;
		line-height: 1.7;
		background: transparent;
		border: none;
		margin-top: 36px;
		overflow-x: auto;
	}

	/* Custom scrollbars */
	pre code::-webkit-scrollbar {
		height: 8px;
	}

	pre code::-webkit-scrollbar-track {
		background: #1a1a2e;
	}

	pre code::-webkit-scrollbar-thumb {
		background: #3a3a50;
		border-radius: 4px;
	}

	pre code::-webkit-scrollbar-thumb:hover {
		background: #4a4a60;
	}
}

/* List view images should have no extra margin */
.list-view-prose :where(img) {
	margin-top: 0;
	margin-bottom: 0;
}

/* Modern syntax highlighting - Dracula-inspired */
pre .token.tag {
	color: #ff79c6;
}

pre .token.attr-name {
	color: #50fa7b;
}

pre .token.attr-value {
	color: #f1fa8c;
}

pre .token.string {
	color: #f1fa8c;
}

pre .token.comment {
	color: #6272a4;
	font-style: italic;
}

pre .token.keyword {
	color: #ff79c6;
}

pre .token.function {
	color: #8be9fd;
}

pre .token.number {
	color: #bd93f9;
}

pre .token.operator {
	color: #ff5555;
}

pre .token.punctuation {
	color: #f8f8f2;
}

pre .token.property {
	color: #50fa7b;
}

pre .token.variable {
	color: #ffb86c;
}
